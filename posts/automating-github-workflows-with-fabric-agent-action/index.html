<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Automating GitHub Workflows with Fabric Agent Action - xvnpw personal blog</title><link rel=icon type=image/png href=/favicon.png><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Introducing the Fabric Agent Action - a GitHub Action that automates complex workflows using AI-powered agents and Fabric Patterns."><meta property="og:image" content><meta property="og:url" content="https://xvnpw.github.io/posts/automating-github-workflows-with-fabric-agent-action/"><meta property="og:site_name" content="xvnpw personal blog"><meta property="og:title" content="Automating GitHub Workflows with Fabric Agent Action"><meta property="og:description" content="Introducing the Fabric Agent Action - a GitHub Action that automates complex workflows using AI-powered agents and Fabric Patterns."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-22T13:59:02+01:00"><meta property="article:modified_time" content="2024-11-22T13:59:02+01:00"><meta property="article:tag" content="Security"><meta property="article:tag" content="Fabric"><meta property="article:tag" content="Llm"><meta property="article:tag" content="Gpt"><meta property="article:tag" content="Ai"><meta property="article:tag" content="Github"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automating GitHub Workflows with Fabric Agent Action"><meta name=twitter:description content="Introducing the Fabric Agent Action - a GitHub Action that automates complex workflows using AI-powered agents and Fabric Patterns."><script src=https://xvnpw.github.io/js/feather.min.js></script><link href=https://xvnpw.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://xvnpw.github.io/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://xvnpw.github.io/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css media="(prefers-color-scheme: dark)"><link rel=stylesheet type=text/css href=https://xvnpw.github.io/css/my.3c46484c36967b544a264fefb69e90ef0756aacf691c82f058e0f58769499ad2.css></head><body><div class=content><header><div class=main><a href=https://xvnpw.github.io/>xvnpw personal blog</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Automating GitHub Workflows with Fabric Agent Action</h1><div class=meta>Posted on Nov 22, 2024</div></div><section class=body><p><a href=https://github.com/xvnpw/fabric-agent-action>Fabric Agent Action</a> is a GitHub Action that bridges the gap between <a href=https://github.com/danielmiessler/fabric>fabric</a> patterns and GitHub workflows. Instead of manually executing patterns or building custom integrations, you can automate complex tasks directly in your GitHub workflows using an agent-based approach.</p><figure class=image-center><img src=https://github.com/user-attachments/assets/14110f11-1250-4792-8d1a-4da3fd85197e width=200></figure><p>The action introduces different types of agents, each designed for specific use cases, from simple pattern execution to complex reasoning about GitHub issues and pull requests. Let&rsquo;s explore how these agents work and evaluate their effectiveness.</p><p><strong>Watch demo:</strong><blockquote class=twitter-tweet><p lang=en dir=ltr>[Fabric Agent Action Demo] <a href=https://t.co/eyjMyNmNcx>https://t.co/eyjMyNmNcx</a></p>&mdash; Marcin Niemiec (@xvnpw) <a href="https://twitter.com/xvnpw/status/1859981296774316495?ref_src=twsrc%5Etfw">November 22, 2024</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></p><h2 id=agents-in-action>Agents in Action</h2><p>The action supports multiple agent types, each with its own characteristics:</p><ol><li>Router Agent - Makes single pattern selection</li><li>ReAct Agent - Implements reasoning and multiple pattern execution</li><li>Specialized GitHub Agents - Optimized for issues and pull requests</li></ol><p>Let&rsquo;s see how to use the Router Agent, which is the simplest one:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Execute Fabric Agent Action</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>xvnpw/fabric-agent-action@v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>input_file</span>: <span style=color:#ae81ff>path/to/input.md</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>output_file</span>: <span style=color:#ae81ff>path/to/output.md</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>agent_type</span>: <span style=color:#e6db74>&#34;router&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>OPENAI_API_KEY</span>: <span style=color:#ae81ff>${{ secrets.OPENAI_API_KEY }}</span>
</span></span></code></pre></div><h2 id=security-first-approach->Security First Approach üõ°Ô∏è</h2><p>Before we dive deeper into capabilities, it&rsquo;s crucial to understand security implications. Use workflow built-in security controls to prevent unauthorized usage:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>if</span>: &gt;<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  github.event.comment.user.login == github.event.repository.owner.login &amp;&amp;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  startsWith(github.event.comment.body, &#39;/fabric&#39;)</span>  
</span></span></code></pre></div><p>This ensures that only repository owners can trigger the action, preventing potential abuse in public repositories.</p><h2 id=agent-types-comparison>Agent Types Comparison</h2><p>Let&rsquo;s compare different agents:</p><table><thead><tr><th>Agent Type</th><th>Approach</th><th>Advantages</th><th>Limitations</th></tr></thead><tbody><tr><td>Router</td><td>Single pattern selection</td><td>Simple, predictable</td><td>No complex workflows</td></tr><tr><td>ReAct</td><td>Multiple patterns with reasoning</td><td>Can chain actions</td><td>More complex, potentially less reliable</td></tr><tr><td>GitHub Specialized</td><td>Context-aware execution</td><td>Understands GitHub context</td><td>Limited to specific scenarios</td></tr></tbody></table><figure class="image-center no-border"><img src=https://github.com/user-attachments/assets/986d3989-0267-41d9-bd44-4f69262bccb3></figure><p>In practice, there&rsquo;s often a trade-off between autonomy and reliability. Increasing LLM autonomy can sometimes reduce reliability due to factors like non-determinism or errors in tool selection.</p><h2 id=real-world-examples>Real-World Examples</h2><p>Let&rsquo;s explore a practical example of how Fabric Agent Action can process GitHub issues. Below is a workflow that enables AI-powered responses to issue comments:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Fabric Pattern Processing using ReAct Issue Agent</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>issue_comment</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [<span style=color:#ae81ff>created, edited]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>process_fabric</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: &gt;<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      github.event.comment.user.login == github.event.repository.owner.login &amp;&amp;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      startsWith(github.event.comment.body, &#39;/fabric&#39;) &amp;&amp;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      !github.event.issue.pull_request</span>      
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>issues</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Prepare Input</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/github-script@v7</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>id</span>: <span style=color:#ae81ff>prepare-input</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            const issue = await github.rest.issues.get({
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              issue_number: context.issue.number,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              owner: context.repo.owner,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              repo: context.repo.repo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            });
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            const comment = await github.rest.issues.getComment({
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              comment_id: context.payload.comment.id,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              owner: context.repo.owner,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              repo: context.repo.repo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            });
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Get all comments for this issue to include in the output
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            const comments = await github.rest.issues.listComments({
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              issue_number: context.issue.number,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              owner: context.repo.owner,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              repo: context.repo.repo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            });
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Extract command from the triggering comment
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            const command = comment.data.body;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            let output = `INSTRUCTION:\n${command}\n\n`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Add issue information
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            output += `GITHUB ISSUE, NR: ${issue.data.number}, AUTHOR: ${issue.data.user.login}, TITLE: ${issue.data.title}\n`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            output += `${issue.data.body}\n\n`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Add all comments
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            for (const c of comments.data) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              if (c.id === comment.data.id) {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              output += `ISSUE COMMENT, ID: ${c.id}, AUTHOR: ${c.user.login}\n`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              output += `${c.body}\n\n`;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            require(&#39;fs&#39;).writeFileSync(&#39;fabric_input.md&#39;, output);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            return output;</span>            
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Execute Fabric Patterns</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker://ghcr.io/xvnpw/fabric-agent-action:v1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>input_file</span>: <span style=color:#e6db74>&#34;fabric_input.md&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>output_file</span>: <span style=color:#e6db74>&#34;fabric_output.md&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>agent_type</span>: <span style=color:#e6db74>&#34;react_issue&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fabric_temperature</span>: <span style=color:#ae81ff>0.2</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fabric_patterns_included</span>: <span style=color:#e6db74>&#34;clean_text,create_stride_threat_model,create_design_document,review_design,refine_design_document,create_threat_scenarios,improve_writing,create_quiz,create_summary&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>debug</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>OPENAI_API_KEY</span>: <span style=color:#ae81ff>${{ secrets.OPENAI_API_KEY }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Post Results</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peter-evans/create-or-update-comment@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>issue-number</span>: <span style=color:#ae81ff>${{ github.event.issue.number }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>body-path</span>: <span style=color:#ae81ff>fabric_output.md</span>
</span></span></code></pre></div><p>This workflow demonstrates several key features:</p><ol><li><strong>Security Controls</strong>: Only repository owners can trigger the action using <code>/fabric</code> commands</li><li><strong>Context Gathering</strong>: Collects issue content, comments, and metadata using GitHub&rsquo;s API</li><li><strong>Pattern Execution</strong>: Processes input through selected Fabric patterns using the ReAct Issue agent</li><li><strong>Automated Response</strong>: Posts results back to the issue as a new comment</li></ol><p>When executed, the action provides AI-generated responses directly in your GitHub issues:</p><figure class="image-center no-border"><img src=https://github.com/user-attachments/assets/707399e3-0c8e-4145-b11c-9e73e97fa66a></figure><h2 id=key-learnings>Key Learnings</h2><h3 id=context-matters>Context Matters</h3><p>Similar to threat modeling, context is crucial for agent effectiveness. The action allows you to provide this context through:</p><ul><li>Input files</li><li>GitHub issue/PR content</li><li>Git diffs</li><li>Comments history</li></ul><h3 id=integration-options>Integration Options</h3><p>The action can be run in multiple ways:</p><ul><li>As a GitHub Action</li><li>Using Docker</li><li>From source code</li></ul><p>This flexibility allows for different integration scenarios and development workflows.</p><h3 id=pattern-management>Pattern Management</h3><p>One interesting challenge is managing the number of available patterns. Models like <code>gpt-4o</code> have a limit of 128 tools, while Fabric includes 175 patterns. The action provides two ways to handle this:</p><ol><li>Including specific patterns:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>fabric_patterns_included</span>: <span style=color:#e6db74>&#34;clean_text,improve_writing&#34;</span>
</span></span></code></pre></div><ol start=2><li>Excluding patterns:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>fabric_patterns_excluded</span>: <span style=color:#e6db74>&#34;create_threat_scenarios&#34;</span>
</span></span></code></pre></div><h2 id=looking-forward>Looking Forward</h2><p>I welcome your feedback and contributions. You can reach out to me on <a href=https://www.linkedin.com/in/marcin-niemiec-304349104/>LinkedIn</a> or <a href=https://x.com/xvnpw>X</a>.</p><p>For those interested in extending the action&rsquo;s capabilities:</p><ul><li>Consider contributing new patterns to the <a href=https://github.com/danielmiessler/fabric>fabric</a> repository first</li><li>For custom patterns, you can fork this action and add them as additional tools</li><li>Share your use cases and experiences to help shape future development</li></ul><p>The goal is to make AI-powered automation more accessible and useful in everyday development workflows while maintaining security and reliability.</p><h2 id=final-thoughts>Final Thoughts</h2><p>In a world where AI is becoming increasingly integrated into our development workflows, tools like Fabric Agent Action show us how we can leverage AI&rsquo;s capabilities in practical, secure, and efficient ways. It&rsquo;s not just about automation - it&rsquo;s about smart automation that understands context and delivers value.</p><p><a href=https://github.com/xvnpw/fabric-agent-action>Code</a> and <a href=https://github.com/xvnpw/fabric-agent-action-examples>examples</a> are available on GitHub.</p><hr><p>Thanks for reading! You can contact me and/or follow me on <a href=https://x.com/xvnpw>X</a>.</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/security>security</a></li><li><a href=/tags/fabric>fabric</a></li><li><a href=/tags/llm>llm</a></li><li><a href=/tags/gpt>gpt</a></li><li><a href=/tags/ai>ai</a></li><li><a href=/tags/github>github</a></li><li><a href=/tags/langchain>langchain</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/xvnpw rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/xvnpw rel=me title=Twitter><i data-feather=twitter></i></a>
<a class=border></a><a class=soc href=https://www.linkedin.com/in/marcin-niemiec-304349104/ rel=me title=Linkedin><i data-feather=linkedin></i></a>
<a class=border></a></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-YHETMXZXMZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YHETMXZXMZ")}</script><script>feather.replace()</script></div></body></html>